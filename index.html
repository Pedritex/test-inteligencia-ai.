<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Inteligencia Profesional</title>
    <link rel="stylesheet" href="style.css"> </head>
<body>

    <div id="landing">
        <h1>Evaluación de Coeficiente Intelectual</h1>
        <p>Inicie nuestra prueba estandarizada para obtener su informe cognitivo.</p>
        <button onclick="empezarTest()">Comenzar Evaluación Profesional</button>
    </div>

    <div id="test-container" style="display:none;">
        <div id="progreso">Pregunta <span id="num-pregunta">1</span> de 15</div>
        <div id="pregunta-texto"></div>
        <div id="opciones"></div>
    </div>

    <div id="payment-wall" style="display:none;">
        <h2>Evaluación Finalizada</h2>
        <p>Sus respuestas han sido procesadas correctamente.</p>
        <p>Precio del informe: <strong>5,00€</strong></p>
        <button id="checkout-button">Desbloquear mi informe de CI</button>
    </div>

    <script>
        let preguntas = [];
    let indiceActual = 0;
    let respuestasUsuario = [];

    // Función para cargar los datos del JSON
    async function cargarPreguntas() {
        const respuesta = await fetch('preguntas.json');
        preguntas = await respuesta.json();
        mostrarPregunta();
    }

    // Función para mostrar la pregunta actual
    function mostrarPregunta() {
        const q = preguntas[indiceActual];
        document.getElementById('num-pregunta').innerText = indiceActual + 1;
        document.getElementById('pregunta-texto').innerText = q.p;
        
        const opcionesDiv = document.getElementById('opciones');
        opcionesDiv.innerHTML = ''; 

        q.o.forEach(opcion => {
            const boton = document.createElement('button');
            boton.innerText = opcion;
            // Aquí llamamos a la función que revisa si terminó el test
            boton.onclick = () => seleccionarRespuesta(opcion);
            opcionesDiv.appendChild(boton);
        });
    }

    // Función que maneja los clics y el final del test
    function seleccionarRespuesta(opcion) {
        respuestasUsuario.push(opcion);
        indiceActual++;

        if (indiceActual === 15) {
            // FIN DEL TEST: Mostramos el muro de pago
            document.getElementById('test-container').style.display = 'none';
            document.getElementById('payment-wall').style.display = 'block';
        } else {
            mostrarPregunta();
        }
    }

    function empezarTest() {
        document.getElementById('landing').style.display = 'none';
        document.getElementById('test-container').style.display = 'block';
        cargarPreguntas();
    }
    </script>
</body>
</html>
